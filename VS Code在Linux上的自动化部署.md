# VS Codeåœ¨Linuxä¸Šçš„è‡ªåŠ¨åŒ–éƒ¨ç½²

## ä¸€ã€å‡†å¤‡å·¥ä½œ

### 1ã€ç¡®ä¿æœ¬åœ°å·²å®‰è£…`rsync`ï¼ˆWindows éœ€é€šè¿‡ WSLå®‰è£…ï¼ŒLinux è‡ªå¸¦ï¼‰

#### ï¼ˆ1ï¼‰**æ ¸å¿ƒå‰æï¼šç¡®ä¿ã€Œæœ¬åœ° Windows ç¯å¢ƒã€èƒ½è¿è¡Œ rsync å‘½ä»¤**

1. ##### **å¯ç”¨ WSL** åŠŸèƒ½ï¼š

   å®‰è£…ç›¸å…³é—®é¢˜è§åç»­ã€‚

2. ##### å®‰è£… rsyncï¼š

- æ‰“å¼€ Windows çš„ â€œå¼€å§‹â€ èœå•ï¼Œæ‰¾åˆ° Ubuntu
- åœ¨ WSL çš„ç»ˆç«¯çª—å£ä¸­ï¼Œè¾“å…¥ `rsync --version` å‘½ä»¤å¹¶å›è½¦ã€‚å¦‚æœ rsync å·²ç»æˆåŠŸå®‰è£…ï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼Œæ˜¾ç¤º rsync çš„ç‰ˆæœ¬å·ç­‰ä¿¡æ¯ï¼š

```bash
rsync  version 3.2.3  protocol version 31
Copyright (C) 1996-2022 by Andrew Tridgell, Wayne Davison, and others.
Web site: https://rsync.samba.org/
```

- æ‰“å¼€ VS Codeï¼Œåœ¨èœå•æ é€‰æ‹© **ç»ˆç«¯ > æ–°å»ºç»ˆç«¯**ï¼Œç¡®ä¿ç»ˆç«¯ç±»å‹æ˜¯ WSLï¼ˆç»ˆç«¯å·¦ä¸Šè§’ä¼šæ˜¾ç¤º `Ubuntu` æˆ–å¯¹åº”çš„å‘è¡Œç‰ˆåç§°ï¼‰ã€‚

- åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤ï¼š

  ```bash
  rsync --version
  ```

- æˆåŠŸå®‰è£…çš„è¡¨ç°ï¼šç»ˆç«¯ä¼šè¾“å‡º rsync çš„ç‰ˆæœ¬ä¿¡æ¯ï¼ˆç±»ä¼¼ä¸‹æ–¹å†…å®¹ï¼‰ï¼š

  ```plaintext
  rsync  version 3.2.7  protocol version 31
  Copyright (C) 1996-2022 by Andrew Tridgell, Wayne Davison, and others.
  Web site: https://rsync.samba.org/
  ```

- æœªå®‰è£…çš„è§£å†³ï¼šåœ¨ WSL ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š

  ```bash
  sudo apt update && sudo apt install rsync -y
  ```

#### ï¼ˆ2ï¼‰**ç¡®ä¿ã€ŒLinux æœåŠ¡å™¨ã€ä¸Šå·²å®‰è£… rsync**

```bash
rsync --version
```

### 2ã€ç¡®ä¿æœ¬åœ°å¯ä»¥é€šè¿‡ SSH æ— å¯†ç ç™»å½•æœåŠ¡å™¨ï¼ˆé¿å…æ¯æ¬¡åŒæ­¥è¾“å…¥å¯†ç ï¼‰

#### ï¼ˆ1ï¼‰**æ‰“å¼€ WSL ç»ˆç«¯**

- åœ¨ Windows æœç´¢æ ä¸­è¾“å…¥ â€œUbuntuâ€ç„¶åç‚¹å‡»æ‰“å¼€ï¼Œè¿›å…¥ WSL ç»ˆç«¯ã€‚
- ä¹Ÿå¯ä»¥åœ¨ VS Code ä¸­æ‰“å¼€ WSL ç»ˆç«¯ï¼ŒæŒ‰ä¸‹`Ctrl+Shift+P`ï¼ˆWindows/Linuxï¼‰æˆ–`Cmd+Shift+P`ï¼ˆMacï¼‰ï¼Œåœ¨å‘½ä»¤é¢æ¿ä¸­è¾“å…¥ â€œWSL: New Terminalâ€ å¹¶é€‰æ‹©ï¼Œå³å¯æ‰“å¼€ WSL ç»ˆç«¯ ã€‚

#### ï¼ˆ2ï¼‰**ç”Ÿæˆ SSH å¯†é’¥**

åœ¨ WSL ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç”Ÿæˆ`ed25519`ç±»å‹çš„ SSH å¯†é’¥å¯¹ï¼ˆä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤çš„`rsa`ç±»å‹ï¼Œå‘½ä»¤ä¸º`ssh-keygen -t rsa`ï¼‰ï¼š

```bash
ssh-keygen -t ed25519
```

- ç³»ç»Ÿä¼šè¯¢é—®ä½ å°†å¯†é’¥æ–‡ä»¶ä¿å­˜åˆ°å“ªé‡Œï¼Œé»˜è®¤è·¯å¾„æ˜¯`~/.ssh/id_ed25519` ï¼Œ<u>ç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤è·¯å¾„å³å¯</u>ã€‚å¦‚æœä½ æƒ³æŒ‡å®šå…¶ä»–è·¯å¾„ï¼Œå¯ä»¥è¾“å…¥å¯¹åº”çš„è·¯å¾„ã€‚
- æ¥ä¸‹æ¥ä¼šæç¤ºä½ è¾“å…¥å¯†é’¥çš„å¯†ç ï¼Œ<u>å»ºè®®ç›´æ¥å›è½¦ï¼Œè®¾ç½®ä¸ºç©ºå¯†ç </u>ï¼Œè¿™æ ·åœ¨å…å¯†ç™»å½•æ—¶å°±æ— éœ€è¾“å…¥å¯†ç ã€‚å¦‚æœè®¾ç½®äº†å¯†ç ï¼Œåœ¨æ¯æ¬¡ç™»å½•æ—¶è¿˜æ˜¯éœ€è¦è¾“å…¥è¿™ä¸ªå¯†ç ï¼Œå°±æ— æ³•å®ç°çœŸæ­£çš„å…å¯†ç™»å½•äº†ã€‚

#### ï¼ˆ3ï¼‰**æŸ¥çœ‹ç”Ÿæˆçš„å¯†é’¥**

å¯†é’¥ç”Ÿæˆå®Œæˆåï¼Œä¼šåœ¨ä½ æŒ‡å®šçš„è·¯å¾„ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œä»¥é»˜è®¤è·¯å¾„ä¸ºä¾‹ï¼š

- `~/.ssh/id_ed25519`ï¼šè¿™æ˜¯ç§é’¥æ–‡ä»¶ï¼Œ**ä¸€å®šè¦å¦¥å–„ä¿ç®¡ï¼Œä¸èƒ½æ³„éœ²**ã€‚
- `~/.ssh/id_ed25519.pub`ï¼šè¿™æ˜¯å…¬é’¥æ–‡ä»¶ï¼Œåç»­éœ€è¦å°†è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å…¬é’¥å†…å®¹ï¼š

```bash
cat ~/.ssh/id_ed25519.pub
```

æ‰§è¡Œå‘½ä»¤åï¼Œä¼šæ˜¾ç¤ºä¸€é•¿ä¸²å­—ç¬¦ï¼Œè¿™å°±æ˜¯å…¬é’¥çš„å†…å®¹ã€‚

#### ï¼ˆ4ï¼‰**å°†å…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨**

åœ¨ WSL ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†å…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š

```bash
ssh-copy-id ç”¨æˆ·å@æœåŠ¡å™¨IP
```

å…¶ä¸­ï¼Œ`ç”¨æˆ·å`æ˜¯ä½ åœ¨æœåŠ¡å™¨ä¸Šçš„ç™»å½•ç”¨æˆ·åï¼Œ`æœåŠ¡å™¨IP`æ˜¯æœåŠ¡å™¨çš„å®é™… IP åœ°å€ã€‚

æ‰§è¡Œå‘½ä»¤åï¼Œç³»ç»Ÿä¼šæç¤ºä½ è¾“å…¥æœåŠ¡å™¨çš„å¯†ç ï¼ˆè¿™æ˜¯é¦–æ¬¡è¿æ¥æ—¶éœ€è¦è¾“å…¥ï¼Œé…ç½®æˆåŠŸåå°±ä¸éœ€è¦äº†ï¼‰ï¼Œè¾“å…¥å¯†ç å¹¶å›è½¦ï¼Œå…¬é’¥å°±ä¼šè¢«ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå¹¶è‡ªåŠ¨æ·»åŠ åˆ°æœåŠ¡å™¨çš„`~/.ssh/authorized_keys`æ–‡ä»¶ä¸­ ã€‚

#### ï¼ˆ5ï¼‰**æµ‹è¯•å…å¯†ç™»å½•**

åœ¨ WSL ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°è¯•ç™»å½•æœåŠ¡å™¨ï¼š

```bash
ssh ç”¨æˆ·å@æœåŠ¡å™¨IP
```

å¦‚æœé…ç½®æˆåŠŸï¼Œä½ å°†æ— éœ€è¾“å…¥å¯†ç ç›´æ¥ç™»å½•åˆ°æœåŠ¡å™¨ ã€‚



## äºŒã€åˆ›å»º VS Code ä»»åŠ¡é…ç½®æ–‡ä»¶

#### 1ã€åœ¨C++ é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»º`.vscode`æ–‡ä»¶å¤¹

#### 2ã€åˆ›å»ºåŒæ­¥ä»»åŠ¡ï¼ˆ`tasks.json`ï¼‰

- åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.vscode` æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»º `tasks.json` æ–‡ä»¶ï¼Œé…ç½®**åŒæ­¥åˆ° Linux æœåŠ¡å™¨**çš„ä»»åŠ¡ï¼š
- `user@192.168.1.100`ï¼šæ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨ç”¨æˆ·åå’Œ IP åœ°å€
- `/home/user/projects/my_cpp_project/`ï¼šæ›¿æ¢ä¸ºæœåŠ¡å™¨ä¸Šçš„é¡¹ç›®å­˜æ”¾è·¯å¾„
- è¦å°†æ•´ä¸ª `Projects` ç›®å½•è‡ªåŠ¨åŒæ­¥åˆ° Linux æœåŠ¡å™¨ï¼Œåªéœ€ä¿®æ”¹ VS Code ä»»åŠ¡é…ç½®ï¼ŒæŒ‡å®šåŒæ­¥æ•´ä¸ªç›®å½•å³å¯

```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Sync to Server", // ä»»åŠ¡åç§°ï¼ˆè‡ªå®šä¹‰ï¼Œæ¯”å¦‚â€œåŒæ­¥åˆ°æœåŠ¡å™¨â€ï¼‰
      "type": "shell", // æ‰§è¡Œ shell å‘½ä»¤
      "command": "rsync", // æ ¸å¿ƒå‘½ä»¤ï¼šrsync
      "args": [
        "-avz", // å½’æ¡£æ¨¡å¼ + æ˜¾ç¤ºè¯¦ç»†æ—¥å¿— + å‹ç¼©ä¼ è¾“ï¼ˆåŠ å¿«é€Ÿåº¦ï¼‰
        "--delete", // åˆ é™¤æœåŠ¡å™¨ä¸Šæœ¬åœ°æ²¡æœ‰çš„æ–‡ä»¶ï¼ˆä¿æŒå®Œå…¨åŒæ­¥ï¼‰
        "--exclude", ".git/", // æ’é™¤ Git ç›®å½•ï¼ˆæœ¬åœ°ç®¡ç†ï¼Œä¸åŒæ­¥åˆ°æœåŠ¡å™¨ï¼‰
        "--exclude", "build/", // æ’é™¤ç¼–è¯‘ç”Ÿæˆç›®å½•ï¼ˆæœ¬åœ°ç¼–è¯‘ï¼ŒæœåŠ¡å™¨æ— éœ€ï¼‰
        // ğŸ‘‡ æœ¬åœ°é¡¹ç›®è·¯å¾„ï¼ˆæ›¿æ¢ä¸ºä½ çš„æœ¬åœ°è·¯å¾„ï¼ŒWindows ç”¨ WSL/Cygwin æ ¼å¼ï¼‰
        "/mnt/e/Projects/", 
        // ğŸ‘‡ æœåŠ¡å™¨è·¯å¾„ï¼ˆæ›¿æ¢ä¸ºâ€œç”¨æˆ·å@IP:æœåŠ¡å™¨é¡¹ç›®è·¯å¾„â€ï¼‰
        "lzy@192.168.126.128:/home/lzy/projects/" 
      ],
      "presentation": {
        "echo": true, // æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œè¿‡ç¨‹
        "reveal": "always", // åŒæ­¥æ—¶è‡ªåŠ¨æ˜¾ç¤ºç»ˆç«¯
        "focus": false, // ä¸è‡ªåŠ¨èšç„¦åˆ°ç»ˆç«¯ï¼ˆä¿æŒä»£ç ç¼–è¾‘ç„¦ç‚¹ï¼‰
        "panel": "shared" // æ‰€æœ‰åŒæ­¥ä»»åŠ¡å…±ç”¨ä¸€ä¸ªç»ˆç«¯é¢æ¿
      },
      "problemMatcher": [] // ä¸å¯ç”¨â€œé—®é¢˜åŒ¹é…â€ï¼ˆå› ä¸ºä¸æ˜¯ç¼–è¯‘ä»»åŠ¡ï¼‰
    }
  ]
}
```



## ä¸‰ã€ä½¿ç”¨åŒæ­¥åŠŸèƒ½

1. åœ¨ VS Code ä¸­ç¼–è¾‘ä½ çš„ C++ ä»£ç 

2. å®Œæˆä¿®æ”¹åï¼ŒæŒ‰`Ctrl+Shift+P`é€‰æ‹©

3. æ­¤æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ rsync å‘½ä»¤ï¼Œå°†ä¿®æ”¹åŒæ­¥åˆ°æœåŠ¡å™¨

4. åœ¨ VS Code çš„ç»ˆç«¯é¢æ¿ä¸­å¯ä»¥æŸ¥çœ‹åŒæ­¥è¿›åº¦å’Œç»“æœ

   

------



## â“ **è¿‡ç¨‹ä¸­äº§ç”Ÿçš„é—®é¢˜ï¼š**

### 1ã€**å¯ç”¨ WSL** 

- Windows ç³»ç»ŸåŸç”Ÿä¸æ”¯æŒ `rsync` å‘½ä»¤ï¼Œéœ€è¦é€šè¿‡ WSL æ¥å®‰è£…ä½¿ç”¨`rsync`


- é¦–å…ˆï¼šä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ â€œå‘½ä»¤æç¤ºç¬¦â€ ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯ç”¨ WSL åŠŸèƒ½

```bash
C:\Windows\system32>dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

éƒ¨ç½²æ˜ åƒæœåŠ¡å’Œç®¡ç†å·¥å…·
ç‰ˆæœ¬: 10.0.19041.3636

æ˜ åƒç‰ˆæœ¬: 10.0.19044.6332

å¯ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½
[==========================100.0%==========================]
æ“ä½œæˆåŠŸå®Œæˆã€‚
```

æ‰§è¡Œå®Œè¯¥å‘½ä»¤åï¼Œé‡å¯è®¡ç®—æœºã€‚

- ç„¶åï¼šæŸ¥çœ‹å¯ç”¨çš„ Linux å‘è¡Œç‰ˆï¼Œåœ¨å‘½ä»¤æç¤ºç¬¦ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ Microsoft Store ä¸­å¯ç”¨çš„ Linux å‘è¡Œç‰ˆï¼š

```bash
wsl --list --online
```

- å®‰è£…æŒ‡å®šçš„ Linux å‘è¡Œç‰ˆï¼šä¾‹å¦‚ï¼Œè¦å®‰è£… `Ubuntu`ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

  ```bash
  wsl --install -d Ubuntu
  ```

ï¼ˆ2ï¼‰**å®‰è£… rsync**ï¼šé‡å¯åï¼Œæ‰“å¼€å®‰è£…å¥½çš„ Linux å‘è¡Œç‰ˆï¼ˆæ¯”å¦‚ Ubuntu ï¼‰ï¼Œåœ¨å…¶ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… `rsync`ï¼š

```bash
sudo apt update
sudo apt install rsync
```

- åœ¨ VS Code ä¸­ä½¿ç”¨ WSL ç»ˆç«¯ï¼š

  æ‰“å¼€ VS Codeï¼ŒæŒ‰ä¸‹Ctrl + `` ï¼ˆé”®ç›˜å·¦ä¸Šè§’æ³¢æµªçº¿æŒ‰é”®ï¼‰æ‰“å¼€ç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ä½ å®‰è£…çš„WSLå‘è¡Œç‰ˆï¼ˆå¦‚Ubuntu ï¼‰ï¼Œæ­¤æ—¶å°±å¯ä»¥åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ rsync` å‘½ä»¤äº†

### 2ã€**é’ˆå¯¹å®‰è£…æŒ‡å®šçš„ Linux å‘è¡Œç‰ˆ `0x80070422` é”™è¯¯**

- #### æ­¥éª¤ 1ï¼šæ£€æŸ¥å¹¶ä¿®å¤ WSL æ‰€éœ€çš„ Windows åŠŸèƒ½

ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ **PowerShell**ï¼ˆä¸æ˜¯å‘½ä»¤æç¤ºç¬¦ï¼ŒPowerShell å¯¹ WSL æ”¯æŒæ›´å‹å¥½ï¼‰ï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
# å¯ç”¨ WSL åŠŸèƒ½
dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

# å¯ç”¨è™šæ‹Ÿæœºå¹³å°ï¼ˆWSL 2 éœ€è¦ï¼Œè‹¥ç”¨ WSL 1 å¯è·³è¿‡ï¼Œä½†å»ºè®®éƒ½å¯ç”¨ï¼‰
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

æ‰§è¡Œå®Œæˆåï¼Œ**é‡å¯ç”µè„‘**ï¼Œè®©åŠŸèƒ½ç”Ÿæ•ˆã€‚

- #### æ­¥éª¤ 2ï¼šæ£€æŸ¥ `Windows Update` å’Œ `BITS` æœåŠ¡

1. æŒ‰ `Win + R`ï¼Œè¾“å…¥ `services.msc` æ‰“å¼€ â€œæœåŠ¡â€ çª—å£ã€‚
2. æ‰¾åˆ°Windows UpdateæœåŠ¡ï¼š
   - è‹¥ â€œå¯åŠ¨ç±»å‹â€ æ˜¯ â€œç¦ç”¨â€ï¼Œæ”¹ä¸º â€œè‡ªåŠ¨â€ï¼Œç„¶åç‚¹å‡» â€œå¯åŠ¨â€ã€‚
   - è‹¥å·²ç»æ˜¯ â€œè‡ªåŠ¨â€ ä½†æ— æ³•å¯åŠ¨ï¼Œå³é”® â†’ â€œå±æ€§â€ â†’ â€œç™»å½•â€ é€‰é¡¹å¡ï¼Œé€‰æ‹© â€œæœ¬åœ°ç³»ç»Ÿè´¦æˆ·â€ï¼Œå†å°è¯•å¯åŠ¨ã€‚
3. æ‰¾åˆ°Background Intelligent Transfer Service (BITS)æœåŠ¡ï¼š
   - åŒæ ·ç¡®ä¿ â€œå¯åŠ¨ç±»å‹â€ ä¸º â€œè‡ªåŠ¨â€ï¼Œä¸”æœåŠ¡å¤„äº â€œæ­£åœ¨è¿è¡Œâ€ çŠ¶æ€ã€‚

- #### æ­¥éª¤ 3ï¼šæ£€æŸ¥ç½‘ç»œå’Œä»£ç†ï¼ˆé‡ç‚¹ï¼ï¼‰

1. `0x80070422` å¾ˆå¯èƒ½æ˜¯**ç½‘ç»œè¿æ¥ä¸ç¨³å®š**æˆ–**ä»£ç†é…ç½®é”™è¯¯**å¯¼è‡´ WSL å®‰è£…åŒ…ä¸‹è½½å¤±è´¥ã€‚
2. å…³é—­ VPNã€ä»£ç†å·¥å…·ï¼ˆå¦‚ Clashã€Shadowsocks ç­‰ï¼‰ï¼Œç¡®ä¿ç”µè„‘ç›´æ¥è¿æ¥ç½‘ç»œã€‚
3. å°è¯•åˆ‡æ¢ç½‘ç»œï¼ˆæ¯”å¦‚ä» Wi-Fi æ¢æœ‰çº¿ï¼Œæˆ–æ‰‹æœºçƒ­ç‚¹ï¼‰ï¼Œå†æ‰§è¡Œ `wsl --install -d Ubuntu`ã€‚

- #### æ­¥éª¤ 4ï¼šé‡ç½® Windows Update ç»„ä»¶ï¼ˆç»ˆææ‰‹æ®µï¼‰

å¦‚æœä¸Šè¿°æ­¥éª¤éƒ½æ— æ•ˆï¼Œä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShellï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤é‡ç½® Windows Update ç»„ä»¶ï¼š

```powershell
# åœæ­¢ç›¸å…³æœåŠ¡
net stop wuauserv
net stop cryptSvc
net stop bits
net stop msiserver

# é‡å‘½åç¼“å­˜æ–‡ä»¶å¤¹
ren C:\Windows\SoftwareDistribution SoftwareDistribution.old
ren C:\Windows\System32\catroot2 catroot2.old

# å¯åŠ¨æœåŠ¡
net start wuauserv
net start cryptSvc
net start bits
net start msiserver
```

æ‰§è¡Œå®Œæˆåï¼Œ**é‡å¯ç”µè„‘**ï¼Œå†å°è¯•å®‰è£… WSLã€‚

### **3ã€æ‰‹åŠ¨ä¸‹è½½ WSL å‘è¡Œç‰ˆç¦»çº¿åŒ…å®‰è£…**

â€‹	å¦‚æœé—®é¢˜2ä¸­æ‰€æœ‰æ–¹æ³•éƒ½å°è¯•è¿‡ï¼Œä»æ— æ³•è§£å†³ `0x80070422` é”™è¯¯å®‰è£… WSLï¼Œå¯èƒ½æ˜¯ç³»ç»Ÿç»„ä»¶æˆ–æ³¨å†Œè¡¨å­˜åœ¨æ·±å±‚é—®é¢˜ï¼Œæ­¤æ—¶å¯ä»¥å°è¯•ä»¥ä¸‹ **æ›´å½»åº•çš„æ›¿ä»£æ–¹æ¡ˆ**ï¼Œç»•å¼€å¸¸è§„å®‰è£…æµç¨‹ï¼š

1. **ä¸‹è½½ Ubuntu ç¦»çº¿åŒ…**

   â€‹	è®¿é—®å¾®è½¯å®˜æ–¹ WSL å‘è¡Œç‰ˆåˆ—è¡¨ï¼šhttps://learn.microsoft.com/zh-cn/windows/wsl/install-manual#downloading-distributionsæ‰¾åˆ° **Ubuntu 22.04 LTS** å¯¹åº”çš„ä¸‹è½½é“¾æ¥ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª `.appx` æˆ– `.zip` æ–‡ä»¶ï¼‰ï¼Œä¾‹å¦‚ï¼šhttps://aka.ms/wslubuntu2204

2. **å®‰è£…ç¦»çº¿åŒ…**

   - ä¸‹è½½åï¼Œå°†æ–‡ä»¶æ‰©å±•åä» `.appx` æ”¹ä¸º `.zip`ï¼ˆå¦‚æœæ˜¯ `.zip` åˆ™ç›´æ¥è§£å‹ï¼‰ã€‚
   - è§£å‹åˆ°ä»»æ„ç›®å½•ï¼ˆä¾‹å¦‚ `C:\Ubuntu`ï¼‰ï¼ŒåŒå‡»è¿è¡Œè§£å‹ç›®å½•ä¸­çš„ `ubuntu2204.exe`ã€‚
   - é¦–æ¬¡è¿è¡Œä¼šåˆå§‹åŒ–ç³»ç»Ÿï¼ŒæŒ‰æç¤ºè®¾ç½®ç”¨æˆ·åå’Œå¯†ç ï¼Œå®Œæˆåå³å¯ä½¿ç”¨ WSLã€‚

3. **è®¾ç½®ä¸º WSL 2ï¼ˆå¯é€‰ï¼‰**ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShellï¼Œæ‰§è¡Œï¼š

   ```powershell
   wsl --set-version Ubuntu-22.04 2  # å°† Ubuntu åˆ‡æ¢åˆ° WSL 2
   wsl --set-default-version 2       # åç»­å®‰è£…é»˜è®¤ä½¿ç”¨ WSL 2
   ```

### 4ã€VS Codeæ–°å»ºç»ˆç«¯æ—¶å‡ºç°æ‰¾ä¸åˆ°WSLç»ˆç«¯çš„é—®é¢˜ï¼Ÿ

- #### æ­¥éª¤ä¸€ï¼šå®‰è£…æ‰©å±•WSL

- #### æ­¥éª¤äºŒï¼šæ‰‹åŠ¨é…ç½® WSL ç»ˆç«¯

  - æŒ‰ä¸‹ `Ctrl+,`ï¼ˆé€—å·ï¼‰æ‰“å¼€ VS Code è®¾ç½®ç•Œé¢ã€‚

  - åœ¨æœç´¢æ¡†ä¸­è¾“å…¥ `terminal.integrated.profiles.windows`

  - ç‚¹å‡» `åœ¨ settings.json ä¸­ç¼–è¾‘`ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼ˆä»¥ Ubuntu ä¸ºä¾‹ï¼‰ï¼š

    ```json
    {
            "[plaintext]": {
                "editor.unicodeHighlight.ambiguousCharacters": false,
                "editor.unicodeHighlight.invisibleCharacters": false
            },
            "remote.SSH.remotePlatform": {
                "192.168.126.128": "linux"
            },
            "terminal.integrated.profiles.windows": {
                // ä¿ç•™åŸæœ‰çš„PowerShellé…ç½®
                "PowerShell": {
                    "source": "PowerShell",
                    "icon": "terminal-powershell"
                },
                // ä¿ç•™åŸæœ‰çš„Command Prompté…ç½®
                "Command Prompt": {
                    "path": [
                        "${env:windir}\\Sysnative\\cmd.exe",
                        "${env:windir}\\System32\\cmd.exe"
                    ],
                    "args": [],
                    "icon": "terminal-cmd"
                },
                // ä¿ç•™åŸæœ‰çš„Git Bashé…ç½®
                "Git Bash": {
                    "source": "Git Bash"
                },
                // æ·»åŠ WSLç»ˆç«¯é…ç½®ï¼ˆæ ¸å¿ƒæ–°å¢éƒ¨åˆ†ï¼‰
                "WSL: Ubuntu": {
                    "path": "wsl.exe",  // è°ƒç”¨WSLæ‰§è¡Œç¨‹åº
                    //"path": "C:\\Windows\\System32\\wsl.exe",  // å¼ºåˆ¶æŒ‡å®šå®Œæ•´è·¯å¾„
                    "args": ["-d", "Ubuntu"],  // æŒ‡å®šWSLå‘è¡Œç‰ˆä¸ºUbuntu
                    "icon": "terminal-ubuntu"  // æ˜¾ç¤ºUbuntuå›¾æ ‡ï¼ˆå¯é€‰ï¼‰
                }
            }, 
            // å¯é€‰ï¼šè®¾ç½®WSLä¸ºé»˜è®¤ç»ˆç«¯ï¼ˆæ‰“å¼€ç»ˆç«¯æ—¶è‡ªåŠ¨ä½¿ç”¨WSLï¼‰
           "terminal.integrated.defaultProfile.windows": "WSL: Ubuntu"
        }
    ```

    PSï¼šè¿™é‡Œæœ‰ä¸ªé—®é¢˜æš‚æ—¶æ²¡è§£å†³ï¼š

    â€‹	å¿…é¡»è®¾ç½®WSLä¸ºé»˜è®¤ç»ˆç«¯ï¼Œæ‰å¯ä»¥åœ¨å½“å‰æœ¬åœ°æ–‡ä»¶å¤¹åŸºç¡€ä¸Šç›´æ¥æ‰“å¼€WSLç»ˆç«¯ï¼Œå¦‚æœåˆ é™¤ `"terminal.integrated.defaultProfile.windows": "WSL: Ubuntu"`ï¼Œå°±ä¼šè‡ªåŠ¨æ‰“å¼€`powershell`ç±»å‹ç»ˆç«¯ã€‚

    â€‹	æ²¡åŠæ³•æ‰¾åˆ°deepssekè¯´çš„ç»ˆç«¯å¯ä»¥ä¸‹æ‹‰ç•Œé¢é€‰æ‹©ç»ˆç«¯ç±»å‹ã€‚